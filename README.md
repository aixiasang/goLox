# ðŸš€ GoLox - Loxè¯­è¨€çš„Goå®žçŽ°

è¿™æ˜¯[Crafting Interpreters](https://craftinginterpreters.fullstack.org.cn/)ä¸­Loxè¯­è¨€çš„Goå®žçŽ°ç‰ˆæœ¬ã€‚

## âœ¨ åŠŸèƒ½ç‰¹æ€§

- ðŸ“ å®Œæ•´çš„è¯æ³•åˆ†æžå™¨ï¼Œæ”¯æŒæ‰€æœ‰Loxçš„æ ‡è®°ç±»åž‹
- ðŸ’¬ æ”¯æŒå•è¡Œæ³¨é‡Š (`//`) å’ŒåµŒå¥—çš„å¤šè¡Œæ³¨é‡Š (`/* ... */`)
- ðŸ” è¯†åˆ«æ‰€æœ‰Loxçš„å…³é”®å­—ã€æ ‡è¯†ç¬¦ã€å­—ç¬¦ä¸²å’Œæ•°å­—å­—é¢é‡
- âš ï¸ è¯¦ç»†çš„é”™è¯¯æŠ¥å‘Šï¼ŒåŒ…å«è¡Œå·

## ðŸ“‚ é¡¹ç›®ç»“æž„

æœ¬é¡¹ç›®é‡‡ç”¨æ¨¡å—åŒ–ç»“æž„è®¾è®¡ï¼Œä¾¿äºŽåŽç»­æ‰©å±•å¼€å‘ï¼š

```
.
â”œâ”€â”€ main.go                 # ç¨‹åºå…¥å£ç‚¹
â”œâ”€â”€ lox/
â”‚   â”œâ”€â”€ token/              # æ ‡è®°å®šä¹‰æ¨¡å—
â”‚   â”‚   â””â”€â”€ token.go        # Tokenå’ŒTokenTypeå®šä¹‰
â”‚   â”œâ”€â”€ scanner/            # è¯æ³•åˆ†æžæ¨¡å—
â”‚   â”‚   â””â”€â”€ scanner.go      # æ‰«æå™¨å®žçŽ°
â”‚   â”œâ”€â”€ parser/             # è¯­æ³•åˆ†æžæ¨¡å—(é¢„ç•™)
â”‚   â”‚   â””â”€â”€ parser.go       # è§£æžå™¨æŽ¥å£å®šä¹‰(é¢„ç•™)
â”‚   â”œâ”€â”€ ast/                # æŠ½è±¡è¯­æ³•æ ‘æ¨¡å—(é¢„ç•™)
â”‚   â”‚   â””â”€â”€ ast.go          # ASTèŠ‚ç‚¹å®šä¹‰(é¢„ç•™)
â”‚   â”œâ”€â”€ interpreter/        # è§£é‡Šæ‰§è¡Œæ¨¡å—(é¢„ç•™)
â”‚   â”‚   â””â”€â”€ interpreter.go  # è§£é‡Šå™¨å®žçŽ°(é¢„ç•™)
â”‚   â”œâ”€â”€ error/              # é”™è¯¯å¤„ç†æ¨¡å—(é¢„ç•™)
â”‚   â”‚   â””â”€â”€ error.go        # é”™è¯¯å¤„ç†å®žçŽ°(é¢„ç•™) 
â”‚   â””â”€â”€ lox.go              # è§£é‡Šå™¨ä¸»æ¡†æž¶
â””â”€â”€ test.lox                # æµ‹è¯•æ–‡ä»¶
```

## ðŸ”§ æ¨¡å—åŒ–è®¾è®¡

### 1. Tokenæ¨¡å— (`lox/token/`)
- å®šä¹‰äº†`TokenType`æžšä¸¾å’Œ`Token`ç»“æž„
- æä¾›Tokenåˆ›å»ºå’Œå­—ç¬¦ä¸²è¡¨ç¤ºåŠŸèƒ½
- è´Ÿè´£ç»´æŠ¤å…³é”®å­—å’Œæ ‡è®°ç±»åž‹æ˜ å°„

### 2. Scanneræ¨¡å— (`lox/scanner/`)
- å®žçŽ°è¯æ³•åˆ†æžå™¨ï¼Œå°†æºä»£ç è½¬æ¢ä¸ºæ ‡è®°åºåˆ—
- å¤„ç†å­—ç¬¦ä¸²ã€æ•°å­—ã€æ ‡è¯†ç¬¦ã€å…³é”®å­—ç­‰
- æ”¯æŒå•è¡Œå’Œå¤šè¡Œæ³¨é‡Š

### 3. Parseræ¨¡å— (`lox/parser/`) - é¢„ç•™
- å°†åœ¨åŽç»­å®žçŽ°è¯­æ³•åˆ†æžå™¨
- å°†æ ‡è®°åºåˆ—è½¬æ¢ä¸ºæŠ½è±¡è¯­æ³•æ ‘

### 4. ASTæ¨¡å— (`lox/ast/`) - é¢„ç•™
- å°†å®šä¹‰æŠ½è±¡è¯­æ³•æ ‘èŠ‚ç‚¹ç±»åž‹
- æ”¯æŒè¡¨è¾¾å¼ã€è¯­å¥å’Œå£°æ˜Ž

### 5. Interpreteræ¨¡å— (`lox/interpreter/`) - é¢„ç•™
- è§£é‡Šæ‰§è¡ŒæŠ½è±¡è¯­æ³•æ ‘
- ç®¡ç†çŽ¯å¢ƒå’Œå˜é‡ä½œç”¨åŸŸ

### 6. Erroræ¨¡å— (`lox/error/`) - é¢„ç•™
- ç»Ÿä¸€çš„é”™è¯¯å¤„ç†æœºåˆ¶
- æ”¯æŒè¯­æ³•é”™è¯¯å’Œè¿è¡Œæ—¶é”™è¯¯

## ðŸš€ ä½¿ç”¨æ–¹æ³•

### ä»Žæºä»£ç æž„å»º

```bash
# å…‹éš†ä»“åº“
git clone https://github.com/your-username/golox.git
cd golox

# æž„å»ºé¡¹ç›®
go build -o golox
```

### è¿è¡Œ

```bash
# äº¤äº’å¼REPLæ¨¡å¼
./golox

# æ‰§è¡ŒLoxè„šæœ¬æ–‡ä»¶
./golox test.lox
```

## ðŸ“ å¾…å®žçŽ°åŠŸèƒ½

- ðŸ§© è§£æžå™¨ - å°†æ ‡è®°è½¬æ¢ä¸ºæŠ½è±¡è¯­æ³•æ ‘
- âš™ï¸ æ‰§è¡Œå™¨ - è§£é‡Šå’Œæ‰§è¡ŒæŠ½è±¡è¯­æ³•æ ‘
- ðŸ”„ å˜é‡ç»‘å®šå’Œä½œç”¨åŸŸ
- ðŸ”€ æŽ§åˆ¶æµç»“æž„
- ðŸ“¦ å‡½æ•°å’Œé—­åŒ…
- ðŸ—ï¸ ç±»å’Œç»§æ‰¿

## ðŸŒŸ æ‰©å±•åŠŸèƒ½

æœ¬å®žçŽ°æ¯”åŽŸä¹¦ä¸­çš„Javaç‰ˆæœ¬æ·»åŠ äº†ä¸€äº›æ‰©å±•åŠŸèƒ½ï¼š

1. ðŸ”„ æ”¯æŒåµŒå¥—çš„å¤šè¡Œæ³¨é‡Š
2. ðŸ›¡ï¸ æ›´å¥å£®çš„è¾¹ç•Œæ£€æŸ¥
3. ðŸ“¦ æ¨¡å—åŒ–çš„ä»£ç ç»“æž„

## ðŸ‘¥ è´¡çŒ®

æ¬¢è¿Žé€šè¿‡Pull Requestæˆ–Issueè´¡çŒ®ä»£ç å’Œæå‡ºå»ºè®®ã€‚

## ðŸ“š å‚è€ƒèµ„æ–™

- [Crafting Interpreters](https://craftinginterpreters.fullstack.org.cn/) - Loxè¯­è¨€è§„èŒƒå’Œè§£é‡Šå™¨å®žçŽ°æŒ‡å— 

# goLox è§£é‡Šå™¨

goLoxæ˜¯ä¸€ä¸ª[Loxç¼–ç¨‹è¯­è¨€](http://craftinginterpreters.com/the-lox-language.html)çš„Goè¯­è¨€å®žçŽ°ï¼Œè¿™æ˜¯ä¸€ä¸ªç®€å•ä½†åŠŸèƒ½å®Œæ•´çš„è„šæœ¬è¯­è¨€ï¼ŒåŒ…å«å˜é‡ã€æŽ§åˆ¶æµã€å‡½æ•°ã€é—­åŒ…ç­‰ç‰¹æ€§ã€‚

## å·²å®žçŽ°åŠŸèƒ½

goLoxç›®å‰å®žçŽ°äº†ä»¥ä¸‹åŠŸèƒ½ï¼š

1. **åŸºæœ¬æ•°æ®ç±»åž‹**
   - æ•°å€¼ï¼ˆæµ®ç‚¹æ•°ï¼‰
   - å­—ç¬¦ä¸²
   - å¸ƒå°”å€¼ï¼ˆtrue/falseï¼‰
   - nil

2. **å˜é‡å’Œè¡¨è¾¾å¼**
   - å˜é‡å£°æ˜Žå’Œèµ‹å€¼
   - ç®—æœ¯è¿ç®—ï¼ˆ+, -, *, /ï¼‰
   - é€»è¾‘è¿ç®—ï¼ˆand, or, !ï¼‰
   - æ¯”è¾ƒè¿ç®—ï¼ˆ==, !=, >, >=, <, <=ï¼‰
   - ä¸‰å…ƒè¿ç®—ç¬¦ï¼ˆcondition ? then : elseï¼‰

3. **æŽ§åˆ¶æµ**
   - if/else æ¡ä»¶è¯­å¥
   - while å¾ªçŽ¯
   - for å¾ªçŽ¯
   - break è¯­å¥

4. **å‡½æ•°**
   - å‡½æ•°å®šä¹‰å’Œè°ƒç”¨
   - é€’å½’
   - è¿”å›žå€¼
   - é—­åŒ…
   - é«˜é˜¶å‡½æ•°ï¼ˆå‡½æ•°ä½œä¸ºå‚æ•°å’Œè¿”å›žå€¼ï¼‰

5. **è¾“å‡º**
   - print è¯­å¥

## å°šæœªå®žçŽ°åŠŸèƒ½

goLoxå½“å‰ç‰ˆæœ¬å°šæœªå®žçŽ°ä»¥ä¸‹åŠŸèƒ½ï¼š

1. **é¢å‘å¯¹è±¡ç¼–ç¨‹**
   - ç±»å®šä¹‰
   - å®žä¾‹åˆ›å»º
   - æ–¹æ³•è°ƒç”¨
   - ç»§æ‰¿

## ä½¿ç”¨æ–¹æ³•

### ç¼–è¯‘

```bash
go build -o goLox.exe main.go
```

### è¿è¡Œæ–‡ä»¶

```bash
./goLox.exe path/to/script.lox
```

### è°ƒè¯•æ¨¡å¼

goLoxæä¾›äº†è°ƒè¯•æ¨¡å¼ï¼Œç”¨äºŽæŸ¥çœ‹è§£æžå’Œæ‰§è¡Œè¿‡ç¨‹çš„è¯¦ç»†ä¿¡æ¯ã€‚åœ¨è°ƒè¯•æ¨¡å¼ä¸‹ï¼Œè§£é‡Šå™¨ä¼šè¾“å‡ºè¯æ³•åˆ†æžã€è¯­æ³•åˆ†æžå’Œæ‰§è¡Œè¿‡ç¨‹ä¸­çš„å„ç§ä¿¡æ¯ï¼ŒåŒ…æ‹¬ï¼š

- å½“å‰å¤„ç†çš„æ ‡è®°ï¼ˆtokenï¼‰
- æ ‡è®°åŒ¹é…æƒ…å†µ
- å‡½æ•°å‚æ•°è§£æžè¿‡ç¨‹
- æœªåŒ¹é…æ ‡è®°çš„ç›¸å…³ä¿¡æ¯

å¯ç”¨è°ƒè¯•æ¨¡å¼æœ‰ä¸¤ç§æ–¹å¼ï¼š

```bash
# ä½¿ç”¨é•¿é€‰é¡¹
./goLox.exe --debug path/to/script.lox

# ä½¿ç”¨çŸ­é€‰é¡¹
./goLox.exe -d path/to/script.lox
```

æ³¨æ„ï¼šè°ƒè¯•æ ‡å¿—å¯ä»¥æ”¾åœ¨å‘½ä»¤çš„ä»»ä½•ä½ç½®ï¼Œè§£é‡Šå™¨ä¼šè‡ªåŠ¨è¯†åˆ«å¹¶ä»Žå‚æ•°åˆ—è¡¨ä¸­ç§»é™¤ã€‚

### äº¤äº’å¼æ¨¡å¼ (REPL)

ä¸æä¾›è„šæœ¬æ–‡ä»¶æ—¶ï¼ŒgoLoxä¼šå¯åŠ¨äº¤äº’å¼è§£é‡Šå™¨ï¼š

```bash
./goLox.exe
```

åœ¨äº¤äº’å¼æ¨¡å¼ä¸­ï¼Œæ‚¨å¯ä»¥é€è¡Œè¾“å…¥Loxä»£ç å¹¶ç«‹å³æŸ¥çœ‹æ‰§è¡Œç»“æžœã€‚

## å‘½ä»¤è¡Œé€‰é¡¹

goLoxæ”¯æŒä»¥ä¸‹å‘½ä»¤è¡Œé€‰é¡¹ï¼š

- `--debug` æˆ– `-d`: å¯ç”¨è°ƒè¯•æ¨¡å¼ï¼Œæ˜¾ç¤ºè§£æžå’Œæ‰§è¡Œçš„è¯¦ç»†ä¿¡æ¯
- è„šæœ¬æ–‡ä»¶è·¯å¾„: è¦æ‰§è¡Œçš„Loxè„šæœ¬æ–‡ä»¶

ç”¨æ³•ç¤ºä¾‹ï¼š
```bash
# è¿è¡Œè„šæœ¬
./goLox.exe script.lox

# å¯ç”¨è°ƒè¯•æ¨¡å¼è¿è¡Œè„šæœ¬
./goLox.exe --debug script.lox
./goLox.exe -d script.lox

# å¯åŠ¨äº¤äº’å¼è§£é‡Šå™¨
./goLox.exe

# å¯åŠ¨è°ƒè¯•æ¨¡å¼çš„äº¤äº’å¼è§£é‡Šå™¨
./goLox.exe --debug
```

## è¯­æ³•ç¤ºä¾‹

### å˜é‡å’Œè¡¨è¾¾å¼

```
var a = 10;
var b = 20;
var c = a + b;
print c;  // è¾“å‡º 30
```

### æ¡ä»¶è¯­å¥

```
if (a > b) {
  print "aå¤§äºŽb";
} else if (a < b) {
  print "aå°äºŽb";
} else {
  print "aç­‰äºŽb";
}
```

### å¾ªçŽ¯

```
// whileå¾ªçŽ¯
var count = 0;
while (count < 5) {
  print count;
  count = count + 1;
}

// forå¾ªçŽ¯
for (var i = 0; i < 5; i = i + 1) {
  print i;
}
```

### å‡½æ•°

```
fun add(a, b) {
  return a + b;
}

print add(5, 3);  // è¾“å‡º 8
```

### é—­åŒ…

```
fun makeCounter() {
  var count = 0;
  fun counter() {
    count = count + 1;
    return count;
  }
  return counter;
}

var counter = makeCounter();
print counter();  // è¾“å‡º 1
print counter();  // è¾“å‡º 2
```

### breakè¯­å¥

```
var i = 0;
while (i < 10) {
  print i;
  i = i + 1;
  if (i == 5) {
    break;
  }
}
```

### é€’å½’

```
// æ–æ³¢é‚£å¥‘æ•°åˆ—
fun fibonacci(n) {
  if (n <= 1) return n;
  return fibonacci(n - 1) + fibonacci(n - 2);
}

// é˜¶ä¹˜
fun factorial(n) {
  if (n <= 1) return 1;
  return n * factorial(n - 1);
}
```

### é«˜é˜¶å‡½æ•°

```
// å‡½æ•°ä½œä¸ºå‚æ•°
fun applyTwice(func, x) {
  return func(func(x));
}

fun double(x) {
  return x * 2;
}

print applyTwice(double, 3);  // è¾“å‡º 12 (3â†’6â†’12)

// è¿”å›žå‡½æ•°
fun makeMultiplier(factor) {
  fun multiply(x) {
    return x * factor;
  }
  return multiply;
}

var triple = makeMultiplier(3);
print triple(4);  // è¾“å‡º 12
```

## ç¤ºä¾‹ç¨‹åº

é¡¹ç›®ä¸­åŒ…å«äº†å¤šä¸ªç¤ºä¾‹ç¨‹åºï¼Œä½äºŽ`example`ç›®å½•ä¸‹ï¼š

- `custom_debug_test.lox`: æµ‹è¯•å„ç§åŸºæœ¬åŠŸèƒ½ï¼ŒåŒ…æ‹¬å˜é‡ã€æŽ§åˆ¶æµã€å‡½æ•°ç­‰
- `function_advanced_test.lox`: æµ‹è¯•å‡½æ•°çš„é«˜çº§ç”¨æ³•ï¼Œå¦‚é—­åŒ…å’Œé«˜é˜¶å‡½æ•°
- `solution_test.lox`: ç®€å•çš„å‡½æ•°è°ƒç”¨ç¤ºä¾‹
- `advanced_recursion.lox`: é«˜çº§é€’å½’ç¤ºä¾‹ï¼ŒåŒ…æ‹¬ï¼š
  - æ–æ³¢é‚£å¥‘æ•°åˆ—ï¼ˆæ™®é€šç‰ˆå’Œè·Ÿè¸ªç‰ˆï¼‰
  - é˜¶ä¹˜è®¡ç®—ï¼ˆæ™®é€šé€’å½’å’Œå°¾é€’å½’ä¼˜åŒ–ï¼‰
  - å¹‚å‡½æ•°ï¼ˆçº¿æ€§é€’å½’å’ŒäºŒåˆ†ä¼˜åŒ–ï¼‰
  - æœ€å¤§å…¬çº¦æ•°
  - å‡½æ•°å·¥åŽ‚
  - æ¨¡æ‹Ÿæ•°ç»„çš„é€’å½’å®žçŽ°

## é™åˆ¶

ç”±äºŽå½“å‰ç‰ˆæœ¬çš„é™åˆ¶ï¼ŒgoLoxä¸æ”¯æŒç±»å’Œç»§æ‰¿ï¼Œå› æ­¤æ— æ³•è¿è¡Œä½¿ç”¨è¿™äº›åŠŸèƒ½çš„ä»£ç ã€‚ 